
最近把devops这本书看完了，消化一下。

## 架构？

以常见的架构来看，架构分为单体架构和多体架构。

我的理解是，前端 + 后端 + 数据库 是一体式的。就像是 Electron + sqlite 这种架构。

没有分离，没有拓展，没有鲁棒。

后面，多体架构就是像 springboot 这种。但 springboot 我有点遗忘了，不详聊。但 nestjs 是我最近在深入研究的一个框架。可以说说。

拿我最近常写的 nest 来说，一个服务对应的是一个 monorepo 。每次实现一个新的需求时，不影响原有的服务。就是服务后面加，前面写好的服务也不会停止。只需要添加调用接口和服务就好了。

```
/app
/app/appa
/app/appb
/app/appc
/lib
/lib/core
/lib/model
/lib/util
...
```

## 测试？

```ts
function add(parama: number, paramb:number){
	return a + b
}

descripe("test demo",()=>{
	it("unit 1",()={
		expect(add(1, 1)).toEqual(2)
	})
})

```

之前在实习过的地方，维护着一个及其巨大的单体系统，没有测试，测试全靠手测。

因为测试要手测，每次启动项目跑编译都是要等巨长时间，于是我去茶水间倒个水才能继续执行手测。

如果可以的话，先跑遍测试，然后再运行编译不就更好了。

### 测试是用来测什么的？

测试函数能不能返回预定的结果，就是 1+1=2 。

如果返回的是 1+1=3，那就抛出错误。

### 如何做？

- 先按照设想的路径跑一遍，给定一个结果，输出一个相同的结果，编写好。
- 设想如果输入不符合的参数，会不会返回一个预期的断言错误，把这一部分加上。
- 如果还有其他地方调用到这个方法，然后这个方法抛出了错误，那就新增一个当前抛出错误的断言，补上，直到正确处理为止。

### 所以有什么用？

如果从项目角度来说，在一个既定已经“完美”的项目里，不会出错，不会有问题，写单测完全就是傻蛋行为。既浪费了时间，又消耗了无用的劳动力。

但是，如果把时间拉到1年后，恐怕就不是这样了。

客户需要想加点服务，但是需要建立在这个服务上才能 + 东西。又或者，人员变动，完全没有人知道这段代码片段能干嘛，深层次的调用完全不敢动。生怕动了就会爆炸。

日积月累，屎山就出来了。

然后某次小改动动到屎山了，还推送到生产环境。

Boom！毕卜——比卜——。这救火队是真的忙，是吧。

测试就是给我提供了一个能修改的空间。断言就是保证我们后来的人接手我的代码还能正常运行的一个保单。

## 部署？

现在你有一个文稿，想把它做成书并在其他书店销售。

文稿即是源码，书就是相当于容器化的服务。书店就是docker。

容器化，就是为了统一开发运行环境，如果说服务炸了，也能很快速的拉取一个制作好的服务 image，然后部署上线。


## 日志

- 遥测

## git



## 错误


## 模型













